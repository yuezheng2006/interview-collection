# DeepSeek AI模型集成说明

## 概述

DeepSeek是一个强大的开源大语言模型，支持中英文，具有优秀的推理能力和创意写作能力。本AI写作助手已成功集成DeepSeek模型，为用户提供高质量的AI写作服务。

## 模型特点

### 核心优势
- **中英文双语支持**: 对中文和英文都有优秀的理解和生成能力
- **推理能力强**: 在逻辑推理和问题分析方面表现优异
- **创意写作**: 擅长创意内容生成，适合文学创作和内容优化
- **开源友好**: 基于开源协议，支持本地部署和定制化

### 技术规格
- **模型名称**: deepseek-chat
- **最大Token数**: 4000
- **温度参数**: 0.7 (平衡创造性和一致性)
- **Top-P参数**: 0.9 (高质量输出)
- **超时设置**: 60秒 (适应复杂推理需求)

## 配置说明

### 环境变量配置

在 `.env` 文件中添加以下配置：

```bash
# DeepSeek配置
DEEPSEEK_API_KEY=your_deepseek_api_key_here
DEEPSEEK_BASE_URL=https://api.deepseek.com/v1/chat/completions
```

### 获取API密钥

1. **访问官网**: 前往 [DeepSeek平台](https://platform.deepseek.com/)
2. **注册账号**: 完成账号注册和验证
3. **开通服务**: 在控制台开通API服务
4. **获取密钥**: 复制API密钥到环境变量

### 配置验证

启动服务后，可以通过以下接口验证配置：

```bash
GET /api/ai/models
```

如果配置正确，应该能看到DeepSeek模型信息，且`isAvailable`为`true`。

## 功能支持

### 1. 续写功能 (Continue)
- **适用场景**: 文章创作、故事续写、内容扩展
- **特点**: 保持原文风格，内容连贯自然
- **提示词**: 专业的续写指导，确保风格一致性

### 2. 润色功能 (Polish)
- **适用场景**: 文本优化、语言提升、表达改进
- **特点**: 提升表达质量，保持原意不变
- **提示词**: 注重流畅性、准确性和表现力

### 3. 总结功能 (Summarize)
- **适用场景**: 长文摘要、要点提取、内容概括
- **特点**: 简洁明了，突出重点
- **提示词**: 结构化总结，便于理解

## 使用流程

### 1. 模型选择
1. 在AI弹窗中点击"选择AI模型"
2. 从下拉列表中选择"DeepSeek Chat"
3. 系统自动切换到DeepSeek模型

### 2. 功能使用
1. 选择要处理的文本
2. 选择AI功能（续写/润色/总结）
3. 输入具体要求（可选）
4. 点击"开始AI处理"
5. 等待DeepSeek模型处理完成

### 3. 结果处理
1. 查看AI生成的结果
2. 选择采纳或拒绝
3. 采纳后结果会自动应用到文档中

## 性能优化

### 请求优化
- **超时设置**: 60秒超时，适应复杂推理需求
- **重试机制**: 网络异常时自动重试
- **错误处理**: 详细的错误信息和恢复建议

### 提示词优化
- **系统提示词**: 针对不同功能优化的专业提示词
- **上下文管理**: 智能处理长文本和复杂上下文
- **风格保持**: 确保输出与原文风格一致

## 最佳实践

### 1. 文本长度控制
- **续写**: 建议选择100-500字符的文本进行续写
- **润色**: 适合处理200-1000字符的文本
- **总结**: 长文本（1000+字符）效果更佳

### 2. 提示词优化
- **具体要求**: 提供具体的修改方向和要求
- **风格说明**: 说明期望的输出风格和格式
- **长度控制**: 指定期望的输出长度

### 3. 模型切换
- **功能匹配**: 根据具体需求选择合适的模型
- **性能考虑**: DeepSeek适合需要推理的复杂任务
- **成本控制**: 合理使用不同模型，平衡效果和成本

## 故障排除

### 常见问题

#### 1. API密钥无效
**症状**: 模型显示为不可用状态
**解决**: 检查API密钥是否正确，确认服务是否开通

#### 2. 请求超时
**症状**: AI处理长时间无响应
**解决**: 检查网络连接，考虑缩短输入文本长度

#### 3. 结果质量不佳
**症状**: AI输出不符合预期
**解决**: 优化提示词，提供更具体的要求

### 调试方法

#### 1. 日志检查
查看后端日志，了解具体的错误信息：
```bash
# 查看服务日志
tail -f backend.log
```

#### 2. API测试
使用curl测试API接口：
```bash
curl -X GET "http://localhost:8080/api/ai/models" \
  -H "Authorization: Bearer your_token"
```

#### 3. 环境变量验证
确认环境变量是否正确设置：
```bash
echo $DEEPSEEK_API_KEY
echo $DEEPSEEK_BASE_URL
```

## 扩展功能

### 1. 自定义模型
可以修改配置使用其他DeepSeek模型：
- `deepseek-coder`: 代码生成和优化
- `deepseek-math`: 数学推理和计算
- `deepseek-vision`: 多模态内容处理

### 2. 参数调优
根据具体需求调整模型参数：
```go
config := DeepSeekConfig{
    Temperature: 0.5,  // 降低温度，提高一致性
    MaxTokens:   2000, // 减少token数，控制输出长度
}
```

### 3. 流式输出
支持流式响应，实时显示生成过程：
```go
request.Stream = true
```

## 成本控制

### 1. Token计费
- **输入Token**: 按实际输入内容计费
- **输出Token**: 按生成内容长度计费
- **优化建议**: 合理控制输入长度，避免不必要的token消耗

### 2. 使用策略
- **功能选择**: 根据任务复杂度选择合适的模型
- **批量处理**: 合并相似任务，减少API调用次数
- **缓存机制**: 对重复请求进行缓存

## 安全考虑

### 1. API密钥保护
- **环境变量**: 使用环境变量存储敏感信息
- **访问控制**: 限制API密钥的访问权限
- **定期轮换**: 定期更新API密钥

### 2. 内容过滤
- **输入验证**: 检查输入内容的合法性
- **输出过滤**: 过滤不当的AI输出内容
- **用户反馈**: 建立用户反馈机制

## 总结

DeepSeek模型的集成为AI写作助手提供了强大的AI能力支持。通过合理的配置和优化，用户可以享受到高质量的AI写作服务，提升创作效率和质量。

### 主要优势
- 🚀 强大的推理和创意能力
- 🌍 优秀的中英文双语支持
- 🔧 灵活的配置和扩展性
- 💰 合理的成本控制策略

### 使用建议
1. 根据具体需求选择合适的AI功能
2. 优化提示词，获得更好的结果
3. 合理控制文本长度，平衡效果和成本
4. 定期检查和更新配置

通过DeepSeek模型，AI写作助手能够为用户提供更加专业、智能的写作辅助服务。 